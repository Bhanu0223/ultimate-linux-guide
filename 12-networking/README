#Netfilter system which enables other kernel modules to offer: packet filtering, NAT and Load balancing
# iptables cmd interacts with the Netfilter system to provide packet filtering and NAT
# The iptables tool is used by services to manage firewall rules.
# linux comes with two such services:
    1. firewalld daemon
    2. iptables services


ðŸ”¹ What is iptables?
iptables is a Linux firewall used to allow, block, or modify network traffic.

ðŸ”¹ Tables (What kind of rule?)
Table	Purpose
filter	Default â€“ allow/deny traffic
nat	Network Address Translation
mangle	Modify packets
raw	Connection tracking exemptions
ðŸ‘‰ Default table = filter

ðŸ”¹ Chains (Where rule applies?)
Chain	Meaning
INPUT	Incoming traffic
OUTPUT	Outgoing traffic
FORWARD	Traffic passing through server
PREROUTING	Before routing decision
POSTROUTING	After routing decision

ðŸ”¹ Basic Syntax
iptables -t <table> -A <chain> <conditions> -j <action>

ðŸ”¹ Common Actions (-j)
Action	Description
ACCEPT	Allow traffic
DROP	Block silently
REJECT	Block + send error
LOG	Log packets
DNAT	Destination NAT
SNAT	Source NAT
MASQUERADE	Dynamic SNAT


ðŸ”¹ View Rules
iptables -L                 # List rules
iptables -L -v              # Verbose
iptables -L -n              # No DNS lookup
iptables -L --line-numbers  # Show rule numbers

ðŸ”¹ Allow Rules
Allow SSH (Port 22)
iptables -A INPUT -p tcp --dport 22 -j ACCEPT
Allow HTTP & HTTPS
iptables -A INPUT -p tcp --dport 80 -j ACCEPT
iptables -A INPUT -p tcp --dport 443 -j ACCEPT
Allow Loopback
iptables -A INPUT -i lo -j ACCEPT

ðŸ”¹ Block Rules
Block an IP
iptables -A INPUT -s 192.168.1.10 -j DROP
Block a Port
iptables -A INPUT -p tcp --dport 21 -j DROP

ðŸ”¹ Default Policy (Very Important)
iptables -P INPUT DROP
iptables -P OUTPUT ACCEPT
iptables -P FORWARD DROP
âš ï¸ Always allow SSH before setting INPUT DROP!

ðŸ”¹ Stateful Firewall (Best Practice)
iptables -A INPUT -m state --state ESTABLISHED,RELATED -j ACCEPT

ðŸ”¹ NAT Rules
Enable IP Forwarding
echo 1 > /proc/sys/net/ipv4/ip_forward
MASQUERADE (Internet sharing)
iptables -t nat -A POSTROUTING -o eth0 -j MASQUERADE
Port Forwarding
iptables -t nat -A PREROUTING -p tcp --dport 8080 -j DNAT --to 192.168.1.10:80

ðŸ”¹ Delete Rules
Delete by Rule Number
iptables -D INPUT 2
Flush All Rules
iptables -F
iptables -t nat -F

ðŸ”¹ Save & Restore Rules
Save
iptables-save > /etc/iptables.rules
Restore
iptables-restore < /etc/iptables.rules

ðŸ”¹ Logging
iptables -A INPUT -p tcp --dport 22 -j LOG --log-prefix "SSH Attempt: "
Check logs:
/var/log/messages
/var/log/syslog
